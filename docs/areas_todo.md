# Areas TODO (A01 Zone Shaping + Overworld Integration)

This is the work queue for turning zone beats + protoadventures into draftable "area shape" YAML files under `world/zones/`.

Read the process first:

- `docs/area_iteration.md`

Authoritative overworld spec:

- `docs/overworld_cartesian_layout.md`

## Status Legend

Proto maturity:

- `needs_proto`: missing cluster coverage; write/adjust protoadventures to cover missing clusters
- `proto_ready`: clusters covered by existing protoadventures (safe to start shaping)

Zone shaping:

- `stub`: zone YAML exists and passes `just areas-validate`
- `shaped`: zone YAML includes planning hints (`cluster_edges`, `key_rooms`, `notes`, `hubs`)

Area files (room graphs):

- `area_stub`: `world/areas/<zone_id>.yaml` exists and passes `just area-files-validate` (usually under room targets)
- `area_budgeted`: area file meets the zone’s cluster room targets (no under-target warnings)

## How To Claim Work (Parallel-Safe)

Don't claim by editing this doc.

Claim by taking a local lock for the zone:

- `just area-lock <zone_id> <claimed_by>`

Lock files live in `locks/areas/` and should not be committed.

## How To Update Status (Scoreboard Hygiene)

This file is the scoreboard, not the lock/claim mechanism.

- Claim work by lock: `just area-lock <zone_id> <claimed_by>`
- Update status only when the underlying artifact exists/validates:
- `shape=stub/shaped`: `just areas-validate` passes
- `area=area_stub`: `just area-files-validate` passes for that file (warnings allowed)
- `area=area_budgeted`: `just area-files-validate` emits no "under target rooms" warnings for that zone
- Keep edits tiny: change one row, don’t reorder the table

## Fast Checks (No Guessing)

- Proto coverage vs official zone beats: `just proto-coverage`
- Overworld + zone shape validity: `just world-validate`
- Refresh derived `protoadventures:` lists inside zone stubs: `just zones-annotate-proto` (or `just zones-annotate-proto <zone_id>`)
- Area file maturity snapshot (filler/setpiece counts): `just area-files-report` (or `just area-files-report <zone_id>`)

## Maturity Loop (After `area_budgeted`)

`area_budgeted` means "meets room targets", not "authored".

Use `just area-files-report` to drive polish:

- High `filler` count: replace filler loops with authored landmarks and setpieces.
- Low `setpiece` count: pull setpieces from protoadventures, or write more protoadventures if the zone lacks strong beats.
- If the zone needs more proto support: update the `next action` column to explicitly call for new protoadventures (side/event/hunt), and only set `proto=needs_proto` if official clusters are truly missing coverage.
- Keep the table lightweight: reflect maturity as a short phrase in the `next action` column (don’t add new columns).

## A01 Zones

Each zone entry includes:

- expected portals (from `docs/overworld_cartesian_layout.md`)
- proto maturity (based on cluster coverage in `docs/zone_beats.md`)
- shaping status
- the next best action

Generated baseline:

- Stub zone shape files exist for every A01 zone at `world/zones/*.yaml` (generated by `just zones-stubgen` / `python3 scripts/zone_shape_stubgen.py`).
- Zone stubs are annotated with `protoadventures:` based on cluster overlap (refresh via `just zones-annotate-proto`).
- Stub area files exist for every A01 zone at `world/areas/*.yaml` (generated by `just area-files-stubgen` / `python3 scripts/area_files_stubgen.py`).

| zone_id | zone | portals | proto | shape | area | missing (clusters) | next action |
| --- | --- | --- | --- | --- | --- | --- | --- |
| `newbie_school` | Newbie School | `P_NS_TOWN` | `proto_ready` | `shaped` | `area_budgeted` |  | iterate room text + quest wiring |
| `town_gaia_gate` | Town: Gaia Gate | `P_TOWN_NS`, `P_TOWN_MEADOW`, `P_TOWN_ORCHARD`, `P_TOWN_SEWERS` | `proto_ready` | `shaped` | `area_budgeted` |  | expand job board into repeatables + add clearer post-choice routing (try: `look board`, `faction civic`) |
| `meadowline` | Meadowline | `P_MEADOW_TOWN`, `P_MEADOW_SEWERS` | `proto_ready` | `shaped` | `area_budgeted` |  | add 1-2 more setpiece pulls + tighten trail->pond->pest return loop |
| `scrap_orchard` | Scrap Orchard | `P_ORCHARD_TOWN`, `P_ORCHARD_SEWERS` | `proto_ready` | `shaped` | `area_budgeted` |  | add rootworks shortcut beats + drone nest lane variety |
| `under_town_sewers` | Under-Town Sewers | `P_SEWERS_TOWN`, `P_SEWERS_MEADOW`, `P_SEWERS_ORCHARD`, `P_SEWERS_QUARRY` | `proto_ready` | `shaped` | `area_budgeted` |  | replace filler loops with authored spokes/loops + boss gate polish |
| `quarry` | Quarry | `P_QUARRY_SEWERS`, `P_QUARRY_CHECKPOINT`, `P_QUARRY_HILLFORT` | `proto_ready` | `shaped` | `area_budgeted` |  | replace filler loops with authored works/pits/dig setpieces |
| `old_road_checkpoint` | Old Road Checkpoint | `P_CHECKPOINT_QUARRY`, `P_CHECKPOINT_HILLFORT`, `P_CHECKPOINT_RAIL`, `P_CHECKPOINT_RUSTWOOD` | `proto_ready` | `shaped` | `area_budgeted` |  | wire `gate.checkpoint.access` unlock (Q4) + playtest rail/rustwood seals |
| `hillfort_ruins` | Hillfort Ruins | `P_HILLFORT_QUARRY`, `P_HILLFORT_CHECKPOINT` | `proto_ready` | `shaped` | `area_budgeted` |  | add banner hall boss + command bunker report-in (safehouse unlock) |
| `rail_spur` | Rail Spur | `P_RAIL_CHECKPOINT` | `proto_ready` | `shaped` | `area_budgeted` |  | add chase UI banner + rescue/service/roofs fork; make lever order/state readable |
| `rustwood` | Rustwood | `P_RUSTWOOD_CHECKPOINT`, `P_RUSTWOOD_LIBRARY` | `proto_ready` | `shaped` | `area_budgeted` |  | wire hunt quest keys + improve trail room naming; align pylon route to library portal |
| `sunken_library` | Sunken Library | `P_LIB_RUSTWOOD`, `P_LIB_FACTORY`, `P_LIB_RESERVOIR` | `proto_ready` | `shaped` | `area_budgeted` |  | wire Q5 plate/decode UX + choice confirm/vote; implement water exposure rules |
| `factory_district_outskirts` | Factory District (Outskirts) | `P_FACTORY_LIBRARY`, `P_FACTORY_RESERVOIR`, `P_FACTORY_UNDERRAIL` | `proto_ready` | `shaped` | `area_budgeted` |  | wire Q7 line disable UX + belt hazards; unlock underrail/reservoir shortcuts |
| `the_reservoir` | The Reservoir | `P_RESERVOIR_LIBRARY`, `P_RESERVOIR_FACTORY`, `P_RESERVOIR_UNDERRAIL` | `proto_ready` | `shaped` | `area_budgeted` |  | wire Q8 control node interactions + flow regulator; unlock underrail entry |
| `the_underrail` | The Underrail | `P_UNDERRAIL_FACTORY`, `P_UNDERRAIL_RESERVOIR`, `P_UNDERRAIL_SKYBRIDGE` | `proto_ready` | `shaped` | `area_budgeted` |  | wire Q9 beacon charge UX + warden gate; unlock skybridge entry |
| `skybridge` | Skybridge | `P_SKYBRIDGE_UNDERRAIL`, `P_SKYBRIDGE_WASTES` | `proto_ready` | `shaped` | `area_budgeted` |  | wire Q10 anchor repair UX + wind marshal; unlock glass wastes entry |
| `glass_wastes` | Glass Wastes | `P_WASTES_SKYBRIDGE`, `P_WASTES_GARDENS` | `proto_ready` | `shaped` | `area_budgeted` |  | wire Q11 storm events + shelter loop; unlock crater gardens entry |
| `crater_gardens` | Crater Gardens | `P_GARDENS_WASTES`, `P_GARDENS_CORE` | `proto_ready` | `shaped` | `area_budgeted` |  | wire Q12 sample collection + root engine gate; unlock core entry |
| `the_core` | The Core | `P_CORE_GARDENS`, `P_CORE_SEAM` | `proto_ready` | `shaped` | `area_budgeted` |  | wire Q13 lock/reset UX + auditor arena pacing |
| `the_seam` | The Seam | `P_SEAM_CORE` | `proto_ready` | `shaped` | `area_budgeted` |  | wire Q14 rule banners + nexus phase swaps + reinforcement choice |
